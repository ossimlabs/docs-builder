<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
       xmlns:p="http://www.springframework.org/schema/p" xmlns:c="http://www.springframework.org/schema/c"
       xmlns:util="http://www.springframework.org/schema/util" xmlns:rbf="http://www.radiantblue.com/schema/rb/foundation"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-3.1.xsd
        http://www.springframework.org/schema/util
        http://www.springframework.org/schema/util/spring-util-3.1.xsd
        http://www.radiantblue.com/schema/rb/foundation
        http://www.radiantblue.com/schema/rb/foundation/rb-foundation-1.0.xsd">

    <bean id="WV01"
          class="com.radiantblue.analytics.isr.core.model.asset.Satellite"
          scope="prototype">

        <property name="name" value="WV01" />
        <property name="id" value="32060" />
        <property name="propagator" ref="WV01_propagator" />

        <property name="ssdr">
            <bean class="com.radiantblue.analytics.isr.core.model.ssdr.SSDR"
                  factory-method="apply">
                <constructor-arg>
                    <rbf:data_volume units="Gb" value="500" />
                </constructor-arg>
            </bean>
        </property>

        <property name="interpolator">
            <bean
                    class="com.radiantblue.analytics.mechanics.statevectors.RawStateVectorProviderInterpolator" />
        </property>

        <property name="revAndPassCalculator" ref="WV01_revPassCalc" />

        <property name="maneuverModel" ref="WV01_manueverModel" />

        <property name="payloads">
            <list>
                <bean class="com.radiantblue.analytics.isr.core.model.payload.Payload">
                    <property name="name" value="WV01_DownlinkPayload" />
                    <property name="accessConstraints">
                        <list>
                            <bean
                                    class="com.radiantblue.analytics.aerospace.geometry.constraint.GrazeConstraint">
                                <property name="range">
                                    <rbf:angular_range units="deg" min="5" max="90" />
                                </property>
                            </bean>
                        </list>
                    </property>

                    <property name="mount">
                        <bean
                                class="com.radiantblue.analytics.isr.core.model.payload.mount.VectorPayloadMount">
                            <property name="payloadXInBodyFrame">
                                <rbf:vector3d delimeter="," value="1,0,0" />
                            </property>
                            <property name="payloadYInBodyFrame">
                                <rbf:vector3d delimeter="," value="0,1,0" />
                            </property>
                            <property name="payloadZInBodyFrame">
                                <rbf:vector3d delimeter="," value="0,0,1" />
                            </property>
                        </bean>
                    </property>

                    <property name="sensors">
                        <list>
                            <bean class="com.radiantblue.analytics.isr.comms.DownlinkSensor">
                                <property name="name" value="WV01_CommSensor" />
                                <property name="modes">
                                    <list>
                                        <bean class="com.radiantblue.analytics.isr.comms.DownlinkCommMode">
                                            <property name="name" value="WV01_DownlinkMode" />
                                            <property name="accessConstraints">
                                                <list>
                                                    <bean
                                                            class="com.radiantblue.analytics.isr.core.component.accgen.constraint.RequirementTypeConstraint">
                                                        <property name="requiredRequirementType"
                                                                  value="com.radiantblue.analytics.isr.core.model.requirement.IDownlinkRequirement" />
                                                    </bean>
                                                </list>
                                            </property>

                                            <property name="attitudeCalculator">
                                                <bean
                                                        class="com.radiantblue.analytics.isr.assets.attitude.GenericTrackingAttitudeSelector">
                                                    <property name="payloadMount">
                                                        <bean
                                                                class="com.radiantblue.analytics.isr.core.model.payload.mount.VectorPayloadMount">
                                                            <property name="payloadXInBodyFrame">
                                                                <rbf:vector3d delimeter="," value="1,0,0" />
                                                            </property>
                                                            <property name="payloadYInBodyFrame">
                                                                <rbf:vector3d delimeter="," value="0,0,-1" />
                                                            </property>
                                                            <property name="payloadZInBodyFrame">
                                                                <rbf:vector3d delimeter="," value="0,1,0" />
                                                            </property>
                                                        </bean>
                                                    </property>
                                                </bean>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>
                <bean class="com.radiantblue.analytics.isr.core.model.payload.Payload">
                    <property name="name" value="WV01_Payload" />
                    <property name="accessConstraints">
                        <list>
                            <bean
                                    class="com.radiantblue.analytics.aerospace.geometry.constraint.SunElevationConstraint">
                                <property name="range">
                                    <rbf:angular_range units="deg" min="15" max="90" />
                                </property>
                            </bean>
                            <bean
                                    class="com.radiantblue.analytics.aerospace.geometry.constraint.CATSConstraint">
                                <property name="range">
                                    <rbf:angular_range units="deg" min="60" max="180" />
                                </property>
                            </bean>
                            <bean
                                    class="com.radiantblue.analytics.aerospace.geometry.constraint.NadirAngleConstraint">
                                <property name="range">
                                    <rbf:angular_range units="deg" min="0" max="30" />
                                </property>
                            </bean>
                            <bean
                                    class="com.radiantblue.analytics.aerospace.geometry.constraint.PassDirectionConstraint">
                                <property name="passDirection" value="DESCENDING" />
                            </bean>
                        </list>
                    </property>

                    <property name="sensors">
                        <list>
                            <bean id="WV01_ScanningSensor"
                                  class="com.radiantblue.analytics.isr.eo.scanner.EOScanner"
                                  p:name="WV01_ScanningSensor">
                                <property name="pixelDefinition">
                                    <bean class="com.radiantblue.analytics.isr.eo.SquarePixel">
                                        <property name="pitch">
                                            <rbf:length units="microns" value="8" />
                                        </property>
                                    </bean>
                                </property>

                                <property name="numPixels" value="35400" />

                                <property name="focalLength">
                                    <rbf:length units="in" value="312.44" />
                                </property>

                                <property name="niirsCalculator">
                                    <bean class="com.radiantblue.analytics.isr.eo.SimpleNiirsCalculator">
                                        <property name="a" value="9.32" />
                                        <property name="b" value="-3.32" />
                                    </bean>
                                </property>
                                <property name="displayFOR">
                                    <bean
                                            class="com.radiantblue.analytics.aerospace.geometry.footprint.NadirFOR">
                                        <property name="maxNadirAngle">
                                            <rbf:angle units="deg" value="30" />
                                        </property>
                                    </bean>
                                </property>

                                <property name="modes">
                                    <list>
                                        <bean id="WV01_ScanMode"
                                              class="com.radiantblue.analytics.isr.eo.scanner.EOScanningMode"
                                              p:name="WV01_ScanMode">

                                            <property name="bitsPerPixel" value="4" />

                                            <property name="lineRateStrategy">
                                                <bean
                                                        class="com.radiantblue.analytics.isr.eo.scanner.ConstantLineRateStrategy">
                                                    <property name="linesPerSecond" value="24000" />
                                                </bean>
                                            </property>

                                            <property name="scanStrategy">
                                                <bean
                                                        class="com.radiantblue.analytics.isr.eo.scanner.DefaultEOScanCalculator">
                                                    <property name="edgePad">
                                                        <rbf:length units="km" value="1" />
                                                    </property>
                                                </bean>
                                            </property>

                                            <property name="attitudeCalculator">
                                                <bean
                                                        class="com.radiantblue.analytics.isr.eo.attitude.FixedScanDirectionAttitudeSelector">
                                                    <property name="scanAzimuthOffNorthCW">
                                                        <rbf:angle units="deg" value="0" />
                                                    </property>
                                                </bean>
                                            </property>

                                            <property name="scanDirectionStrategy">
                                                <bean
                                                        class="com.radiantblue.analytics.isr.eo.scanner.SerpentineScanStrategy" />
                                            </property>
                                        </bean>

                                    </list>

                                </property>

                            </bean>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <!-- Insert any singleton beans into an assets _Beans file. These beans
        will be loaded once while the assets will be initialized each time it is
        accessed -->

    <!-- defines the TLE we want to use -->
    <bean id="WV01_tle"
          class="com.radiantblue.analytics.mechanics.orbit.elementproviders.TLEElementProvider"
          p:line0="WORLDVIEW-1 (WV-1)"
          p:line1="1 32060U 07041A   14063.16654611  .00012788  00000-0  51700-3 0  1744"
          p:line2="2 32060  97.3405 137.6472 0003921  36.8895  19.9325 15.24856874359281">
    </bean>

    <!-- defines an J2 propagator using the TLE -->
    <bean id="WV01_propagator" class="com.radiantblue.analytics.mechanics.orbit.J2Propagator"
          c:provider-ref="WV01_tle" />

    <bean id="WV01_revPassCalc"
          class="com.radiantblue.analytics.mechanics.orbit.revandpass.AscendingNodeRevAndPassCalculator">
        <property name="epochRevAndPass">
            <bean
                    class="com.radiantblue.analytics.mechanics.orbit.revandpass.RevAndPassFromTLE"
                    p:tle-ref="WV01_tle" />
        </property>

        <property name="sampleStep">
            <rbf:timespan units="minutes" value="10" />
        </property>

        <property name="stateVectorProvider" ref="WV01_propagator" />

    </bean>

    <bean id="WV01_manueverModel" class="com.radiantblue.analytics.gnc.maneuver.EigenAxisManeuverModel">
        <property name="rateSelector">
            <bean
                    class="com.radiantblue.analytics.core.maneuver.r3.EllipsoidalEigenAxisRateSelector">
                <property name="javLimits">
                    <bean class="com.radiantblue.analytics.core.maneuver.r3.JAVLimits"
                          factory-method="createSymetric">
                        <constructor-arg index="0" value="4.5" />
                        <constructor-arg index="1" value="2.5" />
                        <constructor-arg index="2" value="100.0" />
                    </bean>
                </property>
            </bean>
        </property>

        <property name="cruiseAttitudeSelector">
            <bean
                    class="com.radiantblue.analytics.isr.assets.attitude.SolarTrackingAttitudeSelector">
                <property name="solarPanelMount">
                    <bean
                            class="com.radiantblue.analytics.isr.core.model.payload.mount.VectorPayloadMount">
                        <property name="payloadZInBodyFrame">
                            <rbf:vector3d delimeter="," value="1,0,0" />
                        </property>
                        <property name="payloadYInBodyFrame">
                            <rbf:vector3d delimeter="," value="0,-1,0" />
                        </property>
                        <property name="payloadXInBodyFrame">
                            <rbf:vector3d delimeter="," value="0,0,1" />
                        </property>
                    </bean>
                </property>
            </bean>
        </property>
    </bean>
</beans>
