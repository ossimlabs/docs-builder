<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:p="http://www.springframework.org/schema/p" xmlns:c="http://www.springframework.org/schema/c"
	xmlns:util="http://www.springframework.org/schema/util" xmlns:rbf="http://www.radiantblue.com/schema/rb/foundation"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-3.1.xsd
        http://www.springframework.org/schema/util
        http://www.springframework.org/schema/util/spring-util-3.1.xsd
        http://www.radiantblue.com/schema/rb/foundation
        http://www.radiantblue.com/schema/rb/foundation/rb-foundation-1.0.xsd">

	
	<bean id="WV03"
		class="com.radiantblue.analytics.isr.core.model.asset.Satellite"
		scope="prototype">

		<property name="name" value="WV03" />
		<property name="id" value="40115" />
		<property name="propagator" ref="WV03_J2" />

		<property name="ssdr" ref="SSDR" />
		<property name="powerSystem" ref="powerSystem" />

		<property name="interpolator">
			<bean
				class="com.radiantblue.analytics.mechanics.statevectors.RawStateVectorProviderInterpolator" />
		</property>

		<property name="revAndPassCalculator" ref="WV03_revPassCalc" />

		<property name="maneuverModel" ref="WV03_manueverModel" />

		<property name="postSchedulingConstraints">
			<list>
				<bean
					class="com.radiantblue.analytics.isr.component.schedule.constraint.power.PostSchedulePowerConstraint">
					<property name="minSOC">
						<array>
							<value>0.75</value>
							<value>0.75</value>
						</array>
					</property>
				</bean>
			</list>

		</property>

		<property name="scheduleConstraints">
			<list>
				<!-- POWER MODELING -->
				<bean
					class="com.radiantblue.analytics.isr.component.schedule.constraint.power.TimeLimitingPowerConstraint">

					<property name="binSize">
						<rbf:timespan units="minutes" value="90" />
					</property>


					<property name="maxOperateTimeBySensor">
						<map>
							<entry key="WV03_ScanningSensor">
								<rbf:timespan units="minutes" value="90" />
							</entry>
						</map>
					</property>
				</bean>
			</list>
		</property>

		<property name="payloads">
			<list>
				<bean class="com.radiantblue.analytics.isr.core.model.payload.Payload">
					<property name="name" value="DownlinkPayload" />
					<property name="accessConstraints">
						<list>
							<bean
								class="com.radiantblue.analytics.aerospace.geometry.constraint.GrazeConstraint">
								<property name="range">
									<rbf:angular_range units="deg" min="5" max="90" />
								</property>
							</bean>
						</list>
					</property>

					<property name="mount">
						<bean
							class="com.radiantblue.analytics.isr.core.model.payload.mount.VectorPayloadMount">
							<property name="payloadXInBodyFrame">
								<rbf:vector3d delimeter="," value="1,0,0" />
							</property>
							<property name="payloadYInBodyFrame">
								<rbf:vector3d delimeter="," value="0,1,0" />
							</property>
							<property name="payloadZInBodyFrame">
								<rbf:vector3d delimeter="," value="0,0,1" />
							</property>
						</bean>
					</property>

					<property name="sensors">
						<list>
							<bean class="com.radiantblue.analytics.isr.comms.DownlinkSensor">
								<property name="name" value="WV03_CommSensor" />
								<property name="modes">
									<list>
										<bean class="com.radiantblue.analytics.isr.comms.DownlinkCommMode">
											<property name="name" value="WV03_DownlinkMode" />
											<!-- POWER MODELING -->
											<property name="avgPowerWatts">
												<array>
													<value>100</value>
													<value>0</value>
												</array>
											</property>
											<property name="accessConstraints">
												<list>
													<bean
														class="com.radiantblue.analytics.isr.core.component.accgen.constraint.RequirementTypeConstraint">
														<property name="requiredRequirementType"
															value="com.radiantblue.analytics.isr.core.model.requirement.IDownlinkRequirement" />
													</bean>
												</list>
											</property>

											<property name="attitudeCalculator">
												<bean
													class="com.radiantblue.analytics.isr.assets.attitude.GenericTrackingAttitudeSelector">
													<property name="payloadMount">
														<bean
															class="com.radiantblue.analytics.isr.core.model.payload.mount.VectorPayloadMount">
															<property name="payloadXInBodyFrame">
																<rbf:vector3d delimeter="," value="1,0,0" />
															</property>
															<property name="payloadYInBodyFrame">
																<rbf:vector3d delimeter="," value="0,0,-1" />
															</property>
															<property name="payloadZInBodyFrame">
																<rbf:vector3d delimeter="," value="0,1,0" />
															</property>
														</bean>
													</property>
												</bean>
											</property>
										</bean>
									</list>
								</property>
							</bean>
						</list>
					</property>
				</bean>

				<bean class="com.radiantblue.analytics.isr.core.model.payload.Payload">
					<property name="name" value="WV03_Payload" />

					<property name="accessConstraints">
						<list>
							<bean
								class="com.radiantblue.analytics.aerospace.geometry.constraint.SunElevationConstraint">
								<property name="range">
									<rbf:angular_range units="deg" min="15" max="90" />
								</property>
							</bean>
							<bean
								class="com.radiantblue.analytics.aerospace.geometry.constraint.CATSConstraint">
								<property name="range">
									<rbf:angular_range units="deg" min="60" max="180" />
								</property>
							</bean>
							<bean
								class="com.radiantblue.analytics.aerospace.geometry.constraint.NadirAngleConstraint">
								<property name="range">
									<rbf:angular_range units="deg" min="0" max="30" />
								</property>
							</bean>
							<bean
								class="com.radiantblue.analytics.aerospace.geometry.constraint.PassDirectionConstraint">
								<property name="passDirection" value="DESCENDING" />
							</bean>
						</list>
					</property>
					<property name="displayFOR">
						<bean
							class="com.radiantblue.analytics.aerospace.geometry.footprint.NadirFOR">
							<property name="maxNadirAngle">
								<rbf:angle units="deg" value="35" />
							</property>
						</bean>
					</property>

					<property name="sensors">
						<list>
							<bean id="WV03_ScanningSensor"
								class="com.radiantblue.analytics.isr.eo.scanner.EOScanner"
								p:name="WV03_ScanningSensor">

								<property name="pixelDefinition">
									<bean class="com.radiantblue.analytics.isr.eo.SquarePixel">
										<property name="pitch">
											<rbf:length units="microns" value="8" />
										</property>
									</bean>
								</property>

								<property name="numPixels" value="42258" />
								<property name="numTDIStages" value="1" />

								<property name="focalLength">
									<rbf:length units="in" value="626.87" />
								</property>

								<property name="niirsCalculator">
									<bean class="com.radiantblue.analytics.isr.eo.SimpleNiirsCalculator">
										<property name="a" value="9.32" />
										<property name="b" value="-3.32" />
									</bean>
								</property>

								<property name="displayFOR">
									<bean
										class="com.radiantblue.analytics.aerospace.geometry.footprint.NadirFOR">
										<property name="maxNadirAngle">
											<rbf:angle units="deg" value="30" />
										</property>
									</bean>
								</property>


								<property name="smearCalculator" >
									<bean
										class="com.radiantblue.analytics.isr.eo.SmearCalculator">
										<property name="defaultTdiStages" value="10.0" />
										<property name="sensorAlignmentProvider">
											<bean class="com.radiantblue.analytics.isr.eo.smear.AttitudeAdapterSensorAlignmentProvider" />
										</property>
									</bean>
								</property>

								<property name="modes">
									<list>
										<bean id="WV03_ScanMode"
											class="com.radiantblue.analytics.isr.eo.scanner.EOScanningMode"
											p:name="WV03_ScanMode">

											<!-- POWER MODELING -->
											<property name="avgPowerWatts">
												<array>
													<value>2000</value>
													<value>500</value>
												</array>
											</property>

											<property name="bitsPerPixel" value="4.51" />

											<property name="lineRateStrategy">
												<bean
													class="com.radiantblue.analytics.isr.eo.scanner.ConstantLineRateStrategy">
													<property name="linesPerSecond" value="24000" />
												</bean>
											</property>

											<property name="scanStrategy">
												<bean
													class="com.radiantblue.analytics.isr.eo.scanner.DefaultEOScanCalculator">
													<property name="edgePad">
														<rbf:length units="km" value="1" />
													</property>
												</bean>
											</property>

											<property name="attitudeCalculator">
												<bean
													class="com.radiantblue.analytics.isr.eo.attitude.FixedScanDirectionAttitudeSelector">
													<property name="scanAzimuthOffNorthCW">
														<rbf:angle units="deg" value="0" />
													</property>
												</bean>
<!-- 												<bean class="com.radiantblue.analytics.isr.eo.attitude.BoreSiteAttitudeSelector" />												 -->
											</property>

											<property name="scanDirectionStrategy">
												<bean
													class="com.radiantblue.analytics.isr.eo.scanner.SerpentineScanStrategy" />
											</property>
										</bean>
									</list>
								</property>
							</bean>
						</list>
					</property>
				</bean>
			</list>
		</property>

		<property name="displayFOR">
			<bean
				class="com.radiantblue.analytics.aerospace.geometry.footprint.NadirFOR">
				<property name="maxNadirAngle">
					<rbf:angle units="deg" value="40" />
				</property>
			</bean>
		</property>

	</bean>

<!-- Insert any singleton beans into an assets _Beans file. These beans 
		will be loaded once while the assets will be initialized each time it is 
		accessed -->

	<!-- defines an J2 propagator -->
	<bean id="WV03_J2" class="com.radiantblue.analytics.mechanics.orbit.J2Propagator">
		<constructor-arg name="provider">
			<bean
				class="com.radiantblue.analytics.mechanics.orbit.elementproviders.SunSyncElementProvider">
				<property name="altitude">
					<rbf:length units="km" value="617" />
				</property>
				<property name="epoch">
					<rbf:date units="string" value="2014-01-01T00:00:00Z" />
				</property>
				<property name="localTimeDescendingNode">
					<!-- 1:30 PM -->
					<rbf:timespan units="minutes" value="810" />
				</property>
			</bean>
		</constructor-arg>
	</bean>

	<bean id="WV03_revPassCalc"
		class="com.radiantblue.analytics.mechanics.orbit.revandpass.AscendingNodeRevAndPassCalculator">
		<property name="stateVectorProvider" ref="WV03_J2" />
		<property name="sampleStep">
			<rbf:timespan units="minutes" value="15" />
		</property>
		<property name="epochRevAndPass">
			<bean
				class="com.radiantblue.analytics.mechanics.orbit.revandpass.RevAndPass">
				<constructor-arg name="atTime">
					<rbf:date units="string" value="2014-01-01T00:00:00.0000Z" />
				</constructor-arg>
				<constructor-arg name="rev" value="1" />
				<constructor-arg name="pass" value="2" />
			</bean>
		</property>
	</bean>

	<bean id="WV03_manueverModel"
		class="com.radiantblue.analytics.gnc.maneuver.EigenAxisManeuverModel">
		<property name="rateSelector">
			<bean
				class="com.radiantblue.analytics.core.maneuver.r3.EllipsoidalEigenAxisRateSelector">
				<property name="javLimits">
					<bean class="com.radiantblue.analytics.core.maneuver.r3.JAVLimits"
						factory-method="createSymetric">
						<constructor-arg index="0" value="4.5" />
						<constructor-arg index="1" value="2.5" />
						<constructor-arg index="2" value="100.0" />
					</bean>
				</property>
			</bean>
		</property>

		<property name="cruiseAttitudeSelector">
			<bean
				class="com.radiantblue.analytics.isr.assets.attitude.SolarTrackingAttitudeSelector">
				<property name="solarPanelMount">
					<bean
						class="com.radiantblue.analytics.isr.core.model.payload.mount.VectorPayloadMount">
						<property name="payloadZInBodyFrame">
							<rbf:vector3d delimeter="," value="1,0,0" />
						</property>
						<property name="payloadYInBodyFrame">
							<rbf:vector3d delimeter="," value="0,-1,0" />
						</property>
						<property name="payloadXInBodyFrame">
							<rbf:vector3d delimeter="," value="0,0,1" />
						</property>
					</bean>
				</property>
			</bean>
		</property>
	</bean>

	<bean id="SSDR"
		class="com.radiantblue.analytics.isr.core.model.ssdr.composite.CompositeSSDR">
		<property name="ssdrs">
			<list>
				<bean class="com.radiantblue.analytics.isr.core.model.ssdr.SSDR"
					factory-method="apply">
					<constructor-arg>
						<rbf:data_volume units="Gb" value="500" />
					</constructor-arg>
				</bean>
				<bean class="com.radiantblue.analytics.isr.core.model.ssdr.SSDR"
					factory-method="apply">
					<constructor-arg>
						<rbf:data_volume units="Gb" value="500" />
					</constructor-arg>
				</bean>
			</list>
		</property>
		<property name="ssdrIndexSelector">
			<bean
				class="com.radiantblue.analytics.isr.core.model.ssdr.composite.LeftRightIndexSelector" />
		</property>
	</bean>

	<bean id="powerSystem" class="rb.astro.power.PowerSystem">
		<property name="batteries">
			<array>
				<!-- battery 0 is a high voltage battery for the payloads -->
				<bean class="rb.astro.power.SimpleBattery">
					<property name="voltage" value="72.0" />
					<property name="maxCharge">
						<rbf:charge units="amp_hours" value="200.0" />
					</property>
					<property name="chargeStrategy">
						<bean class="rb.astro.power.DefaultBatteryChargeStrategy">
							<property name="maxChargeRate_C" value="0.5" />
							<property name="socTaperBegin" value="0.80" />
							<property name="socTaperEnd" value="0.98" />
						</bean>
					</property>
				</bean>
				<!-- battery 1 supports the maneuvers (well, it will eventually) -->
				<bean class="rb.astro.power.SimpleBattery">
					<property name="voltage" value="50.0" />
					<property name="maxCharge">
						<rbf:charge units="amp_hours" value="20.0" />
					</property>
					<property name="chargeStrategy">
						<bean class="rb.astro.power.DefaultBatteryChargeStrategy">
							<property name="maxChargeRate_C" value="0.5" />
							<property name="socTaperBegin" value="0.80" />
							<property name="socTaperEnd" value="0.98" />
						</bean>
					</property>
				</bean>
			</array>
		</property>

		<property name="solarPanels">
			<array>
				<bean class="rb.astro.power.SimpleSolarPanel">
					<property name="nominalVoltage" value="100.0" />
					<property name="maxAmps" value="10.0" />
					<property name="normalInBodyFrame">
						<rbf:vector3d delimeter="," value="0.707106781,0,0.707106781" />
					</property>
					<property name="batteryAllocation">
						<array>
							<value>0.5</value>
							<value>0.5</value>
						</array>
					</property>
				</bean>
				<bean class="rb.astro.power.SimpleSolarPanel">
					<property name="nominalVoltage" value="100.0" />
					<property name="maxAmps" value="10.0" />
					<property name="normalInBodyFrame">
						<rbf:vector3d delimeter="," value="0.707106781,0,-0.707106781" />
					</property>
					<property name="batteryAllocation">
						<array>
							<value>0.5</value>
							<value>0.5</value>
						</array>
					</property>

				</bean>
			</array>
		</property>

		<property name="thermalModelInfo">
			<bean class="rb.astro.power.ThermalModelInformation">
				<property name="moduleInstances">
					<list>
						<bean class="rb.astro.power.ThermalModuleInstance">
							<property name="instanceNumber" value="1" />
							<property name="name" value="SolarPanel" />
							<property name="nodeInstances">
								<list>
									<bean class="rb.astro.power.ThermalNodeInstance">
										<property name="instanceNumber" value="1" />
										<property name="name" value="Interior" />
										<property name="minTemp_C" value="-100"></property>
										<property name="maxTemp_C" value="100"></property>
									</bean>
									<bean class="rb.astro.power.ThermalNodeInstance">
										<property name="instanceNumber" value="2" />
										<property name="name" value="Exterior" />
										<property name="minTemp_C" value="-100"></property>
										<property name="maxTemp_C" value="100"></property>
									</bean>
								</list>
							</property>
						</bean>
						<bean class="rb.astro.power.ThermalModuleInstance">
							<property name="instanceNumber" value="2" />
							<property name="name" value="Radiator" />
							<property name="nodeInstances">
								<list>
									<bean class="rb.astro.power.ThermalNodeInstance">
										<property name="instanceNumber" value="1" />
										<property name="name" value="Radiator-1" />
										<property name="minTemp_C" value="0"></property>
										<property name="maxTemp_C" value="500"></property>
									</bean>
									<bean class="rb.astro.power.ThermalNodeInstance">
										<property name="instanceNumber" value="2" />
										<property name="name" value="Radiator-2" />
										<property name="minTemp_C" value="100"></property>
										<property name="maxTemp_C" value="800"></property>
									</bean>
								</list>
							</property>
						</bean>
					</list>
				</property>
			</bean>
		</property>
	</bean>


</beans>